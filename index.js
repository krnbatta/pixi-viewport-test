$(document).ready(function(){
  debugger
  const map = "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@........@............@........@........@.................@..............@.............@@........@............@........@........@.................@..............@.............@@........@............@........@........@.................@..............@........@@@@@@@........@............@........@........@.................@............................@@........@............@........@........@..............................................@@@@@@....@@@@@@@@@....@...@@@@@@@@@@@...@....@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@...........@@................@................................................@....................@@................@.............................@..................@....................@@................@.............................@..................@....................@@................@.............................@..................@....................@@..............................................@..................@....................@@..............................................@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.....................................................................@@......................................................................................@@......................................................................................@@................@.............................@.......................................@@................@.............................@.......................................@@@@@@@@@@@@@@@@@@@........@@@@@@@@@@@@.........@.......................................@@.........................@..........@.........@.......................................@@.........................@..........@.........@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@................@........@............................................................@@................@........@............................................................@@................@........@....................@.......................................@@................@........@..........@.........@.......................................@@@@@@@@@@@@@@@@@@@........@..........@.........@.......................................@@.........................@..........@.........@.......................................@@.........................@..........@.........@.......................................@@................@........@@@@@@@@@@@@.........@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@................@........@..........@.................................................@@................@........@..........@.................................................@@................@........@..........@.........@.......................................@@@@@@@@@@@@@@@@@@@........@..........@.........@.......................................@@................@........@..........@.........@.......................................@@................@........@..........@.........@.......................................@@................@........@..........@.........@.......................................@@................@........@..........@.........@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@................@........@..........@.................................................@@........@@@.....@........@..........@.................................................@@........@...........................@.................................................@@........@...........................@.........@.......................................@@@@@@@@@@@@@@@@@@@...................@.........@.......................................@@................@...................@.........@.......................................@@................@...................@.........@.......................................@@................@........@..........@.........@.......................................@@................@........@..........@.........@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.........@@@....@........@..........@.........@.......................................@@.........@...............@..........@.........@.......................................@@.........@...............@..........@.................................................@@@@@@@@@@@@@@@@@@@........@..........@.................................................@@.........................@..........@.........@.......................................@@.........................@..........@.........@.......................................@@................@........@@@@@@@@@@@@.........@.......................................@@................@........@..........@.........@.......................................@@................@........@..........@.........@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@................@........@..........@..............................@..................@@................@........@..........@..............................@..................@@................@........@.........................................@..................@@................@........@.........................................@..................@@@@@@@@@@@@@@@@@@@........@....................@....................@..................@@.........................@....................@....................@..................@@.........................@..........@.........@....................@..................@@................@........@..........@.........@....................@..................@@................@........@..........@.........@....................@..................@@................@........@@@@@@@@@@@@.........@....................@..................@@................@.............................@@@@@@@@@@@@@@@@@@@@@@@@@@@@.......@@@@@@@................@.............................@............@..........................@@................@.............................@............@..........................@@................@.............................@............@..........................@@................@.............................@............@..........................@@................@.............................@@@@@....@@@@@@@@@@@@@@@@.........@@@@@@@@@@@@@@@@@@@@@@@@@.....................................................................@@................@.....................................................................@@................@.....................................................................@@................@.....................................................................@@................@.....................................................................@@................@.....................................................................@@......................................................................................@@@@@@@@@@@@@@@@@@@@@@@@@@@.....@@@@@@@@@@@.....@@@@@@@@@@@.......@@@@@@................@@..............................@...............@.................@.....................@@..............................@...............@.................@.....................@@..............................@...............@.................@.....................@@..............................@...............@.................@.....................@@..............................@...............@.................@.....................@@..............................@...............@.................@.....................@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@";
  window.map=map;
  const nodeSize = 20;
  const height = 86;
  const width = 88;
  let app = new PIXI.Application({
      width: width*nodeSize,
      height: height*nodeSize,
      backgroundColor: "0xFFFFFF"
  });
  let canvas = app.view;
  canvas.id = "canvas";
  canvas.height = height*nodeSize;
  canvas.width = width*nodeSize;
  $(".screen").append(canvas);
  let renderer = app.renderer;
  let viewport = new PIXI.extras.Viewport({
      screenWidth: width*nodeSize,
      screenHeight: height*nodeSize,
      worldWidth: width*2*nodeSize,
      worldHeight: height*2*nodeSize,
      interaction: renderer.plugins.interaction,
      stopPropagation: true
  });
  let stage = app.stage;
  stage.addChild(viewport);
  viewport.drag().pinch().wheel().decelerate().clampZoom({ minWidth: 0, minHeight: 0, maxWidth: width * 2 * nodeSize, maxHeight: height * 2 * nodeSize });
  renderer.render(stage);
  let rects = [];
  let tasks = [];
  for (let rowId = 0; rowId < height; ++rowId) {
    for (let colId = 0; colId < width; ++colId) {
      let x = colId * nodeSize;
      let y = rowId * nodeSize;
      let stringIndex = rowId * width + colId;
      if (map[stringIndex]=='@'){
        rects.push(stringIndex);
        let rectangle = new PIXI.Graphics();
        rectangle.lineStyle(1, "0x000000");
        rectangle.beginFill("0x000000");
        rectangle.drawRect(x, y, nodeSize, nodeSize);
        rectangle.endFill();
        viewport.addChild(rectangle);
      }
    }
  }
  console.log(rects);
});
